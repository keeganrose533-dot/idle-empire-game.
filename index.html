<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Idle Empire Game</title>
<style>
/* --- Reset and layout --- */
html, body {
  margin:0; padding:0; width:100%; height:100%;
  display:flex; flex-direction:column;
  font-family:"Segoe UI", sans-serif;
  background:#0f1115; color:white;
}
.topbar{
  background:#181c24; padding:15px;
  display:flex; justify-content:space-around;
  font-size:20px; flex-wrap:wrap;
}
#gameContainer { flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center; width:100%; }

/* --- Pages --- */
.page { width:100%; height:100%; display:none; flex-direction:column; align-items:center; justify-content:center; padding:10px; box-sizing:border-box; }
.page.active { display:flex; }

/* --- Click button --- */
.main-btn{
  padding:10vh 20vw;
  font-size:10vw;
  border:none; border-radius:25px;
  background:#2f80ed; color:white;
  cursor:pointer; transition:0.1s;
  max-width:90%;
}
.main-btn:active{transform:scale(0.95);}

/* --- Shop & achievements cards --- */
.card{ background:#1b2028; margin:15px auto; padding:25px; border-radius:15px; width:85%; max-width:500px; font-size:18px; }
button{ padding:15px; font-size:18px; border:none; border-radius:12px; background:#2a2f3a; color:white; cursor:pointer; width:100%; }
button:hover{background:#3a4150;}

/* --- Navbar --- */
.navbar{
  position:fixed; bottom:0; width:100%; background:#181c24;
  display:flex; justify-content:space-between; padding:0; z-index:100;
}
.navbar button{ flex:1; font-size:20px; padding:20px 0; margin:0; border-radius:0; }

/* --- XP bar --- */
.progress{ width:95%; max-width:1000px; height:45px; background:#222; margin:15px auto; border-radius:20px; overflow:hidden;}
.fill{ height:100%; transition:0.2s; background:#2f80ed; }

/* --- Floating numbers --- */
.floating{ position:absolute; font-weight:bold; color:#2f80ed; animation:floatUp 1s ease-out forwards; pointer-events:none; }
@keyframes floatUp{0%{opacity:1;transform:translateY(0px);}100%{opacity:0;transform:translateY(-50px);}}

/* --- Toasts --- */
.toast{ position:fixed; top:20px; left:50%; transform:translateX(-50%); background:#2f80ed; color:white; padding:18px 30px; border-radius:14px; opacity:0.9; z-index:999; font-size:20px; animation:fadeInOut 2s forwards;}
@keyframes fadeInOut{0%{opacity:0;transform:translateY(-20px);}10%,90%{opacity:0.9;transform:translateY(0);}100%{opacity:0;transform:translateY(-20px);}}

/* --- Mobile scaling --- */
@media (max-width:768px){
  .topbar{ font-size:24px; padding:20px; }
  .navbar button{ font-size:24px; padding:25px 0; }
  .main-btn{ font-size:12vw; padding:15vh 30vw; }
  .card{ font-size:20px; padding:28px; }
  .progress{ height:50px; }
  .toast{ font-size:22px; padding:20px 35px; }
}
</style>
</head>
<body>

<div class="topbar">
  <div>Money: <span id="money">0</span></div>
  <div>Level: <span id="level">1</span></div>
  <div>XP: <span id="xp">0</span>/<span id="xpReq">100</span></div>
  <div>Rebirths: <span id="rebirths">0</span></div>
  <div>Ascensions: <span id="ascensions">0</span></div>
  <div>Tokens: <span id="tokens">0</span></div>
</div>

<div id="gameContainer">
  <div id="mainPage" class="page active">
    <button id="clickBtn" class="main-btn" onclick="clickMoney()">Click!</button>
    <div class="progress"><div id="xpFill" class="fill"></div></div>
    <p>Combo: <span id="combo">0</span></p>
  </div>
  <div id="shopPage" class="page">
    <div id="shopContent"></div>
  </div>
  <div id="achPage" class="page">
    <ul id="achList"></ul>
  </div>
</div>

<div class="navbar">
  <button onclick="show('mainPage')">Main</button>
  <button onclick="show('shopPage')">Shop</button>
  <button onclick="show('achPage')">Achievements</button>
</div>

<script>
// ------------------- JS -------------------
let money=0,level=1,xp=0,rebirths=0,ascensions=0;
let clickPower=1,autoClick=0;
let clickCost=50,autoCost=100;
let tokens=0,tokenUpgrade=0,tokenCost=5;
let combo=0,lastClick=0,totalClicks=0,totalMoney=0,totalAuto=0;

const sounds={
  click:'https://freesound.org/data/previews/341/341695_3248244-lq.mp3',
  levelup:'https://freesound.org/data/previews/331/331912_3248244-lq.mp3',
  rebirth:'https://freesound.org/data/previews/331/331913_3248244-lq.mp3',
  ascend:'https://freesound.org/data/previews/331/331914_3248244-lq.mp3'
};
function playSound(name){let audio=new Audio(sounds[name]); audio.volume=0.3; audio.play();}

let achievements=[
  {name:"First Click", condition:()=>totalClicks>=1, unlocked:false},
  {name:"Click Master", condition:()=>totalClicks>=100, unlocked:false},
  {name:"Rich!", condition:()=>totalMoney>=10000, unlocked:false},
  {name:"Rebirther", condition:()=>rebirths>=5, unlocked:false},
  {name:"Ascender", condition:()=>ascensions>=1, unlocked:false},
  {name:"Auto Clicker", condition:()=>autoClick>=5, unlocked:false},
  {name:"Upgrade Collector", condition:()=>clickPower>=10, unlocked:false},
  {name:"Money Hoarder", condition:()=>money>=1e6, unlocked:false},
];

function format(n){if(n>=1e12)return(n/1e12).toFixed(1)+"T"; if(n>=1e9)return(n/1e9).toFixed(1)+"B"; if(n>=1e6)return(n/1e6).toFixed(1)+"M"; if(n>=1e3)return(n/1e3).toFixed(1)+"K"; return Math.floor(n);}
function xpNeeded(){return Math.max(Math.floor(100*Math.pow(1.16,level-1)),1);}
function globalMulti(){return 1 + rebirths*0.1 + tokenUpgrade*0.05 + ascensions*0.25;}

function update(){
  document.getElementById("money").innerText=format(money);
  document.getElementById("level").innerText=level;
  document.getElementById("rebirths").innerText=rebirths;
  document.getElementById("ascensions").innerText=ascensions;
  document.getElementById("xp").innerText=Math.floor(xp);
  document.getElementById("xpReq").innerText=xpNeeded();
  document.getElementById("combo").innerText=combo;
  document.getElementById("tokens").innerText=tokens;
  let xpBar=document.getElementById("xpFill"); if(xpBar){xpBar.style.width=Math.min((xp/xpNeeded())*100,100)+"%";}
  renderShop(); renderAchievements();
}

function showFloating(text,x,y){let span=document.createElement("span"); span.className="floating"; span.style.left=x+"px"; span.style.top=y+"px"; span.innerText=text; document.body.appendChild(span); setTimeout(()=>span.remove(),1000);}
function showToast(msg){let div=document.createElement("div"); div.className="toast"; div.innerText=msg; document.body.appendChild(div); setTimeout(()=>div.remove(),2000);}
function checkAchievements(){achievements.forEach(a=>{if(!a.unlocked && a.condition()){a.unlocked=true; showToast("Achievement Unlocked: "+a.name);}});}
function renderAchievements(){let list=document.getElementById("achList"); if(!list) return; list.innerHTML=""; achievements.forEach(a=>{let li=document.createElement("li"); li.innerText=a.name+(a.unlocked?" âœ…":""); list.appendChild(li);});}

function clickMoney(){playSound('click'); let now=Date.now(); combo = now-lastClick<1500 ? combo+1 : 0; lastClick=now; let crit=Math.random()<0.05+(rebirths*0.0025)?2:1; let gain=(clickPower+combo*0.1)*crit*globalMulti(); money+=gain; totalMoney+=gain; xp+=gain*0.5; totalClicks++; let btn=document.getElementById("clickBtn"); let rect=btn.getBoundingClientRect(); showFloating("+"+Math.floor(gain),rect.left+rect.width/2,rect.top); if(xp>=xpNeeded()){ xp-=xpNeeded(); level++; playSound('levelup'); showToast("Level Up! "+level);} checkAchievements(); update();}

function renderShop(){let container=document.getElementById("shopContent"); container.innerHTML=""; addShopItem(container,"Click Power","+1 base",clickCost,buyClick); addShopItem(container,"Auto Click","+1/sec",autoCost,buyAuto); if(rebirths>=1) addShopItem(container,"Power Boost","+5% per click",10*rebirths,buyTokenUpgrade);}
function addShopItem(container,title,desc,cost,fn){let card=document.createElement("div"); card.className="card"; card.innerHTML=`<h3>${title}</h3><p>${desc}</p><p>Cost: ${format(cost)}</p>`; let btn=document.createElement("button"); btn.innerText="Buy"; btn.onclick=fn; card.appendChild(btn); container.appendChild(card);}
function buyClick(){if(money>=clickCost){money-=clickCost; clickPower++; clickCost*=1.5; checkAchievements(); update();}}
function buyAuto(){if(money>=autoCost){money-=autoCost; autoClick++; totalAuto++; autoCost*=1.6; checkAchievements(); update();}}
function buyTokenUpgrade(){if(tokens>=tokenCost){tokens-=tokenCost; tokenUpgrade++; tokenCost=Math.floor(tokenCost*1.7); update();}}

function rebirth(){ let req=10+(rebirths*2)+Math.floor(Math.pow(rebirths,1.15)); if(level>=req){rebirths++; tokens++; level=1; xp=0; money=0; clickPower=1; autoClick=0; clickCost=50; autoCost=100; combo=0; playSound('rebirth'); showToast("Rebirth complete! Token +1"); update(); checkAchievements(); } }
function ascend(){ let req=50+ascensions*70; if(rebirths>=req){ascensions++; rebirths=0; tokens=0; tokenUpgrade=0; level=1; xp=0; money=0; clickPower=1; autoClick=0; clickCost=50; autoCost=100; playSound('ascend'); showToast("Ascension achieved!"); update(); checkAchievements(); } }
function show(id){document.querySelectorAll(".page").forEach(p=>p.classList.remove("active")); document.getElementById(id).classList.add("active");}

setInterval(()=>{if(autoClick>0){let gain=autoClick*globalMulti(); money+=gain; totalMoney+=gain; let btn=document.getElementById("clickBtn"); let rect=btn.getBoundingClientRect(); showFloating("+"+Math.floor(gain),rect.left+Math.random()*50,rect.top); checkAchievements(); update();}},1000);

setInterval(()=>{ localStorage.setItem("idleEmpire",JSON.stringify({money, level, xp, rebirths, ascensions, clickPower, autoClick, clickCost, autoCost, tokens, tokenUpgrade, tokenCost, totalClicks, totalMoney, totalAuto, achievements: achievements.map(a=>a.unlocked)}));},3000);

window.onload=()=>{
  let save=JSON.parse(localStorage.getItem("idleEmpire"));
  if(save){
    money=save.money||0; level=save.level||1; xp=save.xp||0;
    rebirths=save.rebirths||0; ascensions=save.ascensions||0;
    clickPower=save.clickPower||1; autoClick=save.autoClick||0;
    clickCost=save.clickCost||50; autoCost=save.autoCost||100;
    tokens=save.tokens||0; tokenUpgrade=save.tokenUpgrade||0; tokenCost=save.tokenCost||5;
    totalClicks=save.totalClicks||0; totalMoney=save.totalMoney||0; totalAuto=save.totalAuto||0;
    if(save.achievements){achievements.forEach((a,i)=>{a.unlocked=save.achievements[i]||false;});}
  }
  update(); renderShop(); renderAchievements();
};
</script>
</body>
</html>
